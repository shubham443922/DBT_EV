SELECT
  OBJECTID,
  MAKE,
  MODEL,
  SUBMODEL,
  MOTIVE_POWER,
  ALTERNATIVE_MOTIVE_POWER,
  TRY_CAST(FIRST_NZ_REGISTRATION_YEAR AS INT) AS registration_year,
  TRY_CAST(FIRST_NZ_REGISTRATION_MONTH AS INT) AS registration_month,
  TRY_CAST(VEHICLE_YEAR AS INT) AS vehicle_year,
  DATE_FROM_PARTS(
    TRY_CAST(FIRST_NZ_REGISTRATION_YEAR AS INT),
    TRY_CAST(FIRST_NZ_REGISTRATION_MONTH AS INT),
    1
  ) AS registration_date,
  CLASS,
  VEHICLE_TYPE,
  VEHICLE_USAGE,
  BODY_TYPE,
  TRANSMISSION_TYPE,
  WIDTH,
  HEIGHT,
  VDAM_WEIGHT,
  GROSS_VEHICLE_MASS,
  POWER_RATING,
  CC_RATING,
  FC_COMBINED,
  FC_URBAN,
  FC_EXTRA_URBAN,
  ORIGINAL_COUNTRY,
  PREVIOUS_COUNTRY,
  IMPORT_STATUS,
  NZ_ASSEMBLED
FROM {{ source('staging', 'RAW_EV_REGISTER') }}
WHERE MOTIVE_POWER ILIKE '%electric%' OR ALTERNATIVE_MOTIVE_POWER ILIKE '%electric%'
